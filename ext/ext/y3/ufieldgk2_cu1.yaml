OUTPUT_DIR: src/cu/solv
KERNEL_NAME: ufieldgk2_cu1
# TEMPLATE_PARAMS:
# CONSTEXPR_FLAGS:

# COUNT:
# ENERGY:
# VIRIAL:
# GRADIENT:

# CUT_DISTANCE:
OFF_DISTANCE: 'off'

# EXCLUDE_INFO: uinfo
# SCALE_1X_TYPE: real_const_array

EXTRA_PARAMS: |
  , const real (*restrict uinds)[3], const real (*restrict uinps)[3]
  , const real* restrict rborn
  , real gkc, real fd
  , real (*restrict fields)[3], real (*restrict fieldps)[3]
# IMPLICIT_PARAMS:

I_VARIABLES:
  - register real xi    from:x
  - register real yi    from:y
  - register real zi    from:z
  - shared   real uidsx from:uinds,0
  - shared   real uidsy from:uinds,1
  - shared   real uidsz from:uinds,2
  - shared   real uipsx from:uinps,0
  - shared   real uipsy from:uinps,1
  - shared   real uipsz from:uinps,2
  - shared   real rbi   from:rborn
K_VARIABLES:
  - register real xk    from:x
  - register real yk    from:y
  - register real zk    from:z
  - register real ukdsx from:uinds,0
  - register real ukdsy from:uinds,1
  - register real ukdsz from:uinds,2
  - register real ukpsx from:uinps,0
  - register real ukpsy from:uinps,1
  - register real ukpsz from:uinps,2
  - register real rbk   from:rborn
I_FORCE:
  - register real fidsx addto:fields,0
  - register real fidsy addto:fields,1
  - register real fidsz addto:fields,2
  - register real fipsx addto:fieldps,0
  - register real fipsy addto:fieldps,1
  - register real fipsz addto:fieldps,2
K_FORCE:
  - register real fkdsx addto:fields,0
  - register real fkdsy addto:fields,1
  - register real fkdsz addto:fields,2
  - register real fkpsx addto:fieldps,0
  - register real fkpsy addto:fieldps,1
  - register real fkpsz addto:fieldps,2

# SCALED_PAIRWISE_INTERACTION:
FULL_PAIRWISE_INTERACTION: |
  real xr = @xk@ - @xi@;
  real yr = @yk@ - @yi@;
  real zr = @zk@ - @zi@;
  real r2 = xr*xr + yr*yr + zr*zr;
  if (r2 <= off * off and incl) {
    pair_ufieldgk2(r2, xr, yr, zr, gkc, fd,
      @uidsx@, @uidsy@, @uidsz@, @uipsx@, @uipsy@, @uipsz@,
      @rbi@,
      @ukdsx@, @ukdsy@, @ukdsz@, @ukpsx@, @ukpsy@, @ukpsz@,
      @rbk@,
      @fidsx@, @fidsy@, @fidsz@, @fipsx@, @fipsy@, @fipsz@,
      @fkdsx@, @fkdsy@, @fkdsz@, @fkpsx@, @fkpsy@, @fkpsz@);
  } // end if (include)
